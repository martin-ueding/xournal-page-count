#!/bin/bash
# Copyright (c) 2012 Martin Ueding <dev@martin-ueding.de>

# Counts the number of pages in the given Xournal documents.

set -e
set -u

# Cost of one sheet of paper, measured in €. This assumes that a box with 2500
# sheets costs 19.95€.
cost_per_page=0.00798

# Height per page, measured in meters.
height_per_page=0.0001

# Mass per page, measured in kilograms.
mass_per_page=0.005

sum=0

for file in "$@"
do
	pages="$(gunzip -c "$file" | grep '<page' | wc -l)"
	sum=$((sum + pages))
	echo "$file has $pages"
done

height=$(python -c "print $height_per_page * $sum")
cost=$(python -c "print $cost_per_page * $sum")
mass=$(python -c "print $mass_per_page * $sum")

echo

echo "Total:"
echo "    $sum pages."
echo "    $height meters in height."
echo "    $mass kilograms"
echo "    $cost €."
